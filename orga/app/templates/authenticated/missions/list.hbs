{{page-title (t "pages.missions.title")}}

<PixNotificationAlert class="mission-list-banner" @type="communication-orga" @withIcon={{true}}>
  {{t "pages.missions.list.banner.welcome"}}
  <br />
  <ul>
    <li>
      {{#if @model.isAdminOfTheCurrentOrganization}}
        <span>{{html-unsafe (t "pages.missions.list.banner.step1.admin.head")}}
          <LinkTo @route="authenticated.import-organization-participants">
            <b>{{t "pages.missions.list.banner.step1.admin.link"}}</b>
          </LinkTo>
          {{html-unsafe (t "pages.missions.list.banner.step1.admin.tail")}}
        </span>
      {{else}}
        <span>{{html-unsafe (t "pages.missions.list.banner.step1.non-admin")}}</span>
      {{/if}}
    </li>
    <li>
      <ul>
        {{t "pages.missions.list.banner.step2.title"}}
        <li>
          <div class="mission-list-banner__copypaste-container">
            <span>{{html-unsafe (t "pages.missions.list.banner.step2.option1" pixJuniorUrl=this.juniorUrl)}}
            </span>
            <div class="mission-list-banner__school-code">
              Code :&nbsp;<b>{{this.schoolCode}}</b>
              <div class="copy-paste-button-container">
                <CopyPasteButton
                  @clipBoardtext={{this.schoolCode}}
                  @successMessage="{{t 'pages.missions.list.banner.copypaste-container.button.success'}}"
                  @defaultMessage="{{t 'pages.missions.list.banner.copypaste-container.button.tooltip'}}"
                />
              </div>
            </div>
          </div>
        </li>
        <li>
          <div class="mission-list-banner__copypaste-container">
            <span>
              {{html-unsafe
                (t
                  "pages.missions.list.banner.step2.option2.body"
                  pixJuniorUrl=@model.pixJuniorSchoolUrl
                  code=this.schoolCode
                )
              }}
              <a href={{@model.pixJuniorSchoolUrl}} target="_blank" rel="noopener noreferrer" id="external-link-icon">
                <PixIcon @name="openNew" />
              </a>
            </span>
            <span>
              {{html-unsafe (t "pages.missions.list.banner.step2.option2.hint")}}
            </span>
          </div>
        </li>
      </ul>
    </li>
    <li>
      <span>{{html-unsafe (t "pages.missions.list.banner.step3")}}</span>
    </li>
  </ul>
</PixNotificationAlert>

<Ui::PageTitle>
  <:title>{{t "pages.missions.title"}}</:title>
</Ui::PageTitle>

{{#if @model.missions}}
  <PixTable
    @variant="orga"
    @data={{@model.missions}}
    @caption={{t "pages.missions.list.caption"}}
    @onRowClick={{this.goToMissionDetails}}
  >
    <:columns as |mission context|>
      <PixTableColumn @context={{context}}>
        <:header>{{t "pages.missions.list.headers.name"}}</:header>
        <:cell>{{mission.name}}</:cell>
      </PixTableColumn>

      <PixTableColumn @context={{context}}>
        <:header>{{t "pages.missions.list.headers.competences"}}</:header>
        <:cell>{{mission.competenceName}}</:cell>
      </PixTableColumn>

      <PixTableColumn @context={{context}}>
        <:header>{{t "pages.missions.list.headers.started-by"}}</:header>
        <:cell>
          {{#if (eq mission.startedBy "")}}
            {{t "pages.missions.list.no-division"}}
          {{else}}
            {{mission.startedBy}}
          {{/if}}
        </:cell>
      </PixTableColumn>

      <PixTableColumn @context={{context}}>
        <:header>{{t "pages.missions.list.headers.actions"}}</:header>
        <:cell>
          <PixButtonLink @route="authenticated.missions.mission" @model={{mission.id}} @variant="tertiary">
            {{t "pages.missions.list.actions.see-mission-details"}}
          </PixButtonLink>
        </:cell>
      </PixTableColumn>
    </:columns>
  </PixTable>

{{else}}
  <div class="table__empty content-text">
    {{t "pages.missions.list.empty-state"}}
  </div>
{{/if}}